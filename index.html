<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–û—Ç–∫—Ä—ã—Ç–∫–∏</title>
  <style>
    :root { --card-bg: rgba(255,255,255,.75); --shadow: 0 8px 24px rgba(0,0,0,.1); }
    html, body { height: 100%; }
    body {
      margin: 0; font-family: "Segoe UI","Helvetica Neue",sans-serif; color:#333;
      display:flex; align-items:center; justify-content:center;
      background:#f7f5f2 center/cover no-repeat fixed;
      transition: background-image .4s ease;
    }
    body.bg-menu { background-image:url("background-menu.jpg"); }
    body.bg-a    { background-image:url("background-a.jpg"); } /* 28.10.2025 */
    body.bg-b    { background-image:url("background-b.jpg"); } /* 29.10.2025 */
    body.bg-c    { background-image:url("background-c.jpg"); } /* 30.10.2025 */
    body.bg-d    { background-image:url("background-dlya-tebya.jpg"); } /* –î–ª—è —Ç–µ–±—è */
    body.bg-e    { background-image:url("background-invite.jpg"); } /* –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ */

    .wrap { width:100%; padding:20px; display:flex; justify-content:center; align-items:center; }
    .card {
      background:var(--card-bg); backdrop-filter:blur(8px);
      border-radius:24px; box-shadow:var(--shadow);
      padding:36px 28px; max-width:560px; width:100%; text-align:center;
    }

    .text {
      font-size:1.25rem; line-height:1.6; min-height:3.2em;
      opacity:0; transform:translateY(10px);
      transition:opacity .5s ease, transform .5s ease;
    }
    .text.show { opacity:1; transform:translateY(0); }

    .controls { margin-top:26px; display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap; }
    button {
      background:#f0d9b5; border:none; border-radius:12px; padding:10px 20px; font-size:1rem;
      cursor:pointer; transition:background .3s ease, transform .2s ease;
    }
    button:hover { background:#f7e5c4; transform:translateY(-2px); }
    .hidden { display:none !important; }

    .menu-grid { display:grid; grid-template-columns:1fr; gap:14px; }
    .menu-btn  { display:flex; align-items:center; justify-content:center; gap:10px; width:100%; padding:14px 18px; font-weight:600; }

    .sunrise { animation: fadeInUp 1.1s ease forwards; }
    @keyframes fadeInUp { from{opacity:0;transform:translateY(14px)} to{opacity:1;transform:translateY(0)} }

    audio { width: 100%; margin-top: 12px; }

    /* –≤—ã–±–æ—Ä –¥–ª—è –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è */
    #inviteChoices { display:flex; justify-content:center; gap:16px; margin-top:20px; }
  </style>
</head>
<body class="bg-menu">
  <div class="wrap">
    <div class="card">

      <!-- –ú–ï–ù–Æ -->
      <div id="menu" class="menu-grid">
        <button id="openA" class="menu-btn">28.10.2025</button>
        <button id="openB" class="menu-btn">29.10.2025</button>
        <button id="openC" class="menu-btn">30.10.2025</button>
        <button id="openD" class="menu-btn">–î–ª—è —Ç–µ–±—è</button>
        <button id="openE" class="menu-btn" style="opacity:.95">–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ</button>
      </div>

      <!-- –¢–ï–ö–°–¢ -->
      <p id="text" class="text hidden"></p>

      <!-- –í–´–ë–û–† (–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ) -->
      <div id="inviteChoices" class="hidden">
        <button id="agree">—Å–æ–≥–ª–∞—Å–Ω–∞</button>
        <button id="disagree">–Ω–µ —Å–æ–≥–ª–∞—Å–Ω–∞</button>
      </div>

      <!-- –ù–ê–í–ò–ì–ê–¶–ò–Ø -->
      <div id="nav" class="controls hidden">
        <button id="prev">‚Üê –ù–∞–∑–∞–¥</button>
        <button id="next">–î–∞–ª–µ–µ ‚Üí</button>
      </div>
    </div>
  </div>

  <script>
    const elText  = document.getElementById("text");
    const menu    = document.getElementById("menu");
    const nav     = document.getElementById("nav");
    const btnOpenA = document.getElementById("openA");
    const btnOpenB = document.getElementById("openB");
    const btnOpenC = document.getElementById("openC");
    const btnOpenD = document.getElementById("openD");
    const btnOpenE = document.getElementById("openE");
    const btnPrev  = document.getElementById("prev");
    const btnNext  = document.getElementById("next");
    const inviteChoices = document.getElementById("inviteChoices");
    const btnAgree = document.getElementById("agree");
    const btnDisagree = document.getElementById("disagree");

    let view = "menu";
    let index = 0;
    let inviteChoice = null;

    // === 28.10.2025 ===
    const slidesA = [/* —Ç–≤–æ–∏ —Ç–µ–∫—Å—Ç—ã */];
    // === 29.10.2025 ===
    const slidesB = [/* —Å—Ç–∏—Ö–∏ */];
    // === 30.10.2025 ===
    const slidesC = [/* –ø–µ—Å–Ω—è */];
    // === –î–ª—è —Ç–µ–±—è ===
    const slidesD = [/* —Ç–≤–æ–∏ —Å—Ç–∏—Ö–∏ */];

    // === –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ ===
    const slidesE = [
      "–ü—Ä–∏–≤–µ—Ç, –õ–∏—Å–∏—Ü–∞! ü¶ä",
      "–ó–Ω–∞—é, –¥–æ—Ä–æ–≥–∞ –∑–∞–±—Ä–∞–ª–∞ –º–Ω–æ–≥–æ —Å–∏–ª –∏ –Ω–µ—Ä–≤–æ–≤...",
      "–î–∞–≤–∞–π –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –∑–∞–±—É–¥–µ–º –ø—Ä–æ –Ω–∞—à–∏ —Ä–∞–∑–Ω–æ–≥–ª–∞—Å–∏—è.",
      "–Ø –Ω–µ–º–Ω–æ–≥–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª—Å—è –∫ —ç—Ç–æ–º—É –≤–µ—á–µ—Ä—É.",
      "–¢—ã —Å–æ–≥–ª–∞—Å–Ω–∞?"
    ];
    const slidesYes = [
      "–ü—Ä–∏–µ–∑–∂–∞–π. –í–æ–π–¥–∏ –≤ –∫–æ–º–Ω–∞—Ç—É –∏ –ø—Ä–æ—Å—Ç–æ –∂–¥–∏, –ø–æ–∫–∞ —è –ø–æ–∑–æ–≤—É.",
      "–ë—É–¥–µ—Ç –Ω–µ–ø–ª–æ—Ö–æ, –µ—Å–ª–∏ —Ç—ã –Ω–∞–¥–µ–Ω–µ—à—å –∫—Ä–∞—Å–∏–≤–æ–µ –ø–ª–∞—Ç—å–µ."
    ];
    const slidesNo = [
      "–≠—Ç–æ –±—ã–ª –≤—ã–±–æ—Ä –±–µ–∑ –≤—ã–±–æ—Ä–∞. –ù–∞–∂–º–∏ ¬´–ù–∞–∑–∞–¥¬ª –∏ ¬´–°–æ–≥–ª–∞—Å–Ω–∞¬ª."
    ];

    function applyBackground(v){
      document.body.className="";
      if(v==="menu") document.body.classList.add("bg-menu");
      if(v==="cardA") document.body.classList.add("bg-a");
      if(v==="cardB") document.body.classList.add("bg-b");
      if(v==="cardC") document.body.classList.add("bg-c");
      if(v==="cardD") document.body.classList.add("bg-d");
      if(v==="cardE") document.body.classList.add("bg-e");
    }

    function notifySelection(choice){
      try{
        fetch("https://fragrant-brook-cbe0.n-alekseev-work.workers.dev/api/notify",{
          method:"POST",
          headers:{ "Content-Type":"application/json" },
          body:JSON.stringify({ choice, time:new Date().toISOString() })
        }).catch(()=>{});
      }catch{}
    }

    function pauseAllAudio(){
      document.querySelectorAll("audio").forEach(a => { try { a.pause(); a.currentTime = 0; } catch{} });
    }

    function setView(newView){
      pauseAllAudio();
      view = newView;
      applyBackground(view);
      inviteChoice = null;

      if(view === "menu"){
        menu.classList.remove("hidden");
        elText.classList.add("hidden");
        nav.classList.add("hidden");
        inviteChoices.classList.add("hidden");
        return;
      }

      menu.classList.add("hidden");
      elText.classList.remove("hidden");
      nav.classList.remove("hidden");
      inviteChoices.classList.add("hidden");
      index = 0;
      renderSlide();
    }

    function getSlides(){
      if(view==="cardA") return slidesA;
      if(view==="cardB") return slidesB;
      if(view==="cardC") return slidesC;
      if(view==="cardD") return slidesD;
      if(view==="cardE"){
        if(inviteChoice==="yes") return slidesYes;
        if(inviteChoice==="no") return slidesNo;
        return slidesE;
      }
      return [];
    }

    function renderSlide(){
      pauseAllAudio();
      const slides = getSlides();
      const t = slides[index] || "";

      elText.classList.remove("show");
      void elText.offsetWidth;
      elText.innerHTML = t;
      elText.classList.add("show");

      if(view==="cardE" && inviteChoice===null && index===slidesE.length-1){
        nav.classList.add("hidden");
        inviteChoices.classList.remove("hidden");
      } else {
        inviteChoices.classList.add("hidden");
        nav.classList.remove("hidden");
        btnNext.classList.toggle("hidden", index >= slides.length - 1);
      }
    }

    function openCard(which){
      const name = which==="cardA"?"28.10.2025":
                   which==="cardB"?"29.10.2025":
                   which==="cardC"?"30.10.2025":
                   which==="cardD"?"–î–ª—è —Ç–µ–±—è":"–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ";
      notifySelection(name);
      setView(which);
    }

    btnOpenA.onclick = ()=>openCard("cardA");
    btnOpenB.onclick = ()=>openCard("cardB");
    btnOpenC.onclick = ()=>openCard("cardC");
    btnOpenD.onclick = ()=>openCard("cardD");
    btnOpenE.onclick = ()=>openCard("cardE");

    btnNext.onclick = ()=>{
      const slides = getSlides();
      if(index < slides.length-1){ index++; renderSlide(); }
    };

    // üîπ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –±–ª–æ–∫ "–ù–∞–∑–∞–¥"
    btnPrev.onclick = ()=>{
      if(view==="menu") return;

      // –æ—Å–æ–±–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è
      if(view==="cardE"){
        if((inviteChoice==="yes" || inviteChoice==="no") && index===0){
          // –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ –≤–æ–ø—Ä–æ—Å "–¢—ã —Å–æ–≥–ª–∞—Å–Ω–∞?"
          inviteChoice = null;
          index = slidesE.length - 1;
          renderSlide();
          return;
        }
      }

      // —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
      if(index===0){ setView("menu"); }
      else { index--; renderSlide(); }
    };

    btnAgree.onclick = ()=>{
      inviteChoice="yes";
      notifySelection("–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ ‚Äî —Å–æ–≥–ª–∞—Å–Ω–∞");
      index=0; renderSlide();
    };
    btnDisagree.onclick = ()=>{
      inviteChoice="no";
      notifySelection("–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ ‚Äî –Ω–µ —Å–æ–≥–ª–∞—Å–Ω–∞");
      index=0; renderSlide();
    };

    setView("menu");
  </script>
</body>
</html>
